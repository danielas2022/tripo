---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import LinkButton from "@components/LinkButton.astro";
import Hr from "@components/Hr.astro";
import Card from "@components/Card";
import Socials from "@components/Socials.astro";
import getSortedPosts from "@utils/getSortedPosts";
import { SOCIALS } from "@config";
import { Image } from "astro:assets";

const posts = await getCollection("blog");

const sortedPosts = getSortedPosts(posts);
const featuredPosts = sortedPosts.filter(({ data }) => data.featured);
const recentPosts = sortedPosts.filter(({ data }) => !data.featured);

const socialCount = SOCIALS.filter(social => social.active).length;
---

<script
  async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7405228778340178"
  crossorigin="anonymous"></script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LNP93QDFE6"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());

  gtag("config", "G-LNP93QDFE6");
</script>

<Layout>
  <Header />
  <div class="mb-8 text-center">
    <h1 class="text-2xl font-bold" style="font-size: 1.5rem; line-height: 1.5;">
      TripoSR AI<br />
      Rapidly Generate<br />
      High-Quality 3D Assets From A Single 2D Image
    </h1>
    <div class="original-iframe-container">
      <iframe
        class="original-iframe"
        src="https://akbartus-3dgentriposr.hf.space"
        frameborder="0"
        width="850"
        height="450"></iframe>
    </div>

    <section class="flex justify-center items-center space-x-4 py-8">
      <div>
        <img
          src="https://github.com/VAST-AI-Research/TripoSR/blob/main/figures/teaser800.gif?raw=true"
          alt="Input Image"
          class="w-124 h-64 object-cover rounded-lg shadow-lg"
        />
        <p class="text-center mt-2">Input Image</p>
      </div>
      <div>
        <img
          src="https://github.com/3DTopia/OpenLRM/blob/main/assets/rendered_video/teaser.gif?raw=true"
          alt="3D Reconstruction"
          class="w-104 h-64 object-cover rounded-lg shadow-lg"
        />
        <p class="text-center mt-2">3D Reconstruction</p>
      </div>
    </section>

    <section class="bg-white text-zinc-900 py-8 sm:py-16">
      <div class="max-w-screen-xl mx-auto px-6 lg:px-16">
        <div class="mb-8">
          <h2 class="text-4xl font-bold">Frequently Asked Questions</h2>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <h3 class="text-lg font-medium text-zinc-800">What is TripoSR?</h3>
            <p class="text-base text-zinc-500">
              TripoSR is a state-of-the-art, open-source model for fast 3D
              reconstruction from a single image, collaboratively developed by
              Tripo AI and Stability AI.
            </p>
          </div>
          <div>
            <h3 class="text-lg font-medium text-zinc-800">
              How does TripoSR work?
            </h3>
            <p class="text-base text-zinc-500">
              TripoSR generates a mesh from a given image by processing the
              image as a NumPy array and then returning a tuple containing the
              preprocessed image and the name of the generated mesh file.
            </p>
          </div>
          <div>
            <h3 class="text-lg font-medium text-zinc-800">
              Can I improve the texture resolution in TripoSR?
            </h3>
            <p class="text-base text-zinc-500">
              Yes, texture resolution improvements are possible. Users have
              discussed modifying the color sampling code to enhance texture
              quality, which has shown to be effective.
            </p>
          </div>
          <div>
            <h3 class="text-lg font-medium text-zinc-800">
              Is TripoSR compatible with ComfyUI?
            </h3>
            <p class="text-base text-zinc-500">
              There have been efforts to integrate TripoSR with ComfyUI,
              including the creation of a custom node for ComfyUI to experiment
              with TripoSR. However, users have reported issues with
              dependencies and errors during integration.
            </p>
          </div>
          <div>
            <h3 class="text-lg font-medium text-zinc-800">
              Are there any scripts available to increase texture resolution in
              TripoSR?
            </h3>
            <p class="text-base text-zinc-500">
              Yes, there are scripts available that aim to increase the texture
              resolution of the meshes generated by TripoSR. These scripts can
              be found on GitHub and have been shared by the community.
            </p>
          </div>
          <div>
            <h3 class="text-lg font-medium text-zinc-800">
              How can I get started with TripoSR?
            </h3>
            <p class="text-base text-zinc-500">
              To get started with TripoSR, you can visit the official GitHub
              repository for documentation and code examples. This will provide
              you with the necessary information to begin experimenting with 3D
              mesh generation from images.
            </p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <Hr />

  {
    featuredPosts.length > 0 && (
      <>
        <section id="featured">
          <h2>Featured </h2>
          <ul>
            {featuredPosts.map(({ data, slug }) => (
              <Card
                href={`/posts/${slug}/`}
                frontmatter={data}
                secHeading={false}
              />
            ))}
          </ul>
        </section>
        {recentPosts.length > 0 && <Hr />}
      </>
    )
  }

  {
    recentPosts.length > 0 && (
      <section id="recent-posts">
        <h2>Recent Posts</h2>
        <ul>
          {recentPosts.map(
            ({ data, slug }, index) =>
              index < 4 && (
                <Card
                  href={`/posts/${slug}/`}
                  frontmatter={data}
                  secHeading={false}
                />
              )
          )}
        </ul>
      </section>
    )
  }

  <div class="all-posts-btn-wrapper">
    <LinkButton href="/posts/">
      All Posts
      <svg xmlns="http://www.w3.org/2000/svg"
        ><path
          d="m11.293 17.293 1.414 1.414L19.414 12l-6.707-6.707-1.414 1.414L15.586 11H6v2h9.586z"
        ></path>
      </svg>
    </LinkButton>
  </div>

  <Footer />

  <style>
    /* ===== Hero Section ===== */
    #hero {
      @apply pb-6 pt-8;
    }
    #hero h1 {
      @apply my-4 inline-block text-3xl font-bold sm:my-8 sm:text-5xl;
    }
    #hero .rss-link {
      @apply mb-6;
    }
    #hero .rss-icon {
      @apply mb-2 h-6 w-6 scale-110 fill-skin-accent sm:mb-3 sm:scale-125;
    }
    #hero p {
      @apply my-2;
    }
    .social-wrapper {
      @apply mt-4 flex flex-col sm:flex-row sm:items-center;
    }
    .social-links {
      @apply mb-1 mr-2 whitespace-nowrap sm:mb-0;
    }

    /* ===== Featured & Recent Posts Sections ===== */
    #featured,
    #recent-posts {
      @apply pb-6 pt-12;
    }
    #featured h2,
    #recent-posts h2 {
      @apply text-2xl font-semibold tracking-wide;
    }
    .all-posts-btn-wrapper {
      @apply my-8 text-center;
    }
  </style>
</Layout>
